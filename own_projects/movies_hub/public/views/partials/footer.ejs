<!-- Developed By Section -->
<footer
    class="mt-2 text-center text-gray-500 text-sm flex items-center justify-center space-x-2 pb-12 mb-[40px] select-none">
    <svg fill="#000000" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" xml:space="preserve" width="24px" height="24px">
        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
        <g id="SVGRepo_iconCarrier">
            <style type="text/css">
                .st0 {
                    fill: none;
                }
            </style>
            <path
                d="M19.2,4.4L2.9,10.7c-1.1,0.4-1.1,1.1-0.2,1.3l4.1,1.3l1.6,4.8c0.2,0.5,0.1,0.7,0.6,0.7c0.4,0,0.6-0.2,0.8-0.4 c0.1-0.1,1-1,2-2l4.2,3.1c0.8,0.4,1.3,0.2,1.5-0.7l2.8-13.1C20.6,4.6,19.9,4,19.2,4.4z M17.1,7.4l-7.8,7.1L9,17.8L7.4,13l9.2-5.8 C17,6.9,17.4,7.1,17.1,7.4z">
            </path>
            <rect y="0" class="st0" width="24" height="24"></rect>
        </g>
    </svg>
    <span>
        Developed By
        <a href="https://t.me/<%= developer_telegram_username %>" target="_blank" class="text-blue-600 hover:underline">
            Bots & Mini App Creater
        </a>
    </span>
</footer>

<!-- Bottom Navigation -->
<footer class="bg-[#1f1f1f] shadow-inner border-t border-gray-700 fixed bottom-0 left-0 right-0">
    <div class="flex justify-between items-center text-white relative">

        <!-- Send Request (Left) -->
        <a data-ad="interstitial"
            href="/<%= token %>/movies-hub/send-request?userId=<%= user_id %>&fromId=<%= typeof fromId !== 'undefined' ? fromId : '' %>"
            class="flex-1 text-center py-3 <%= currentPath === '/movies-hub/send-request' ? 'text-blue-300 bg-gray-600' : '' %>">
            <svg class="mx-auto w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path d="M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2" />
                <circle cx="8.5" cy="7" r="4" />
                <path d="M20 8v6M23 11h-6" />
            </svg>
            <span class="text-xs block">Request</span>
        </a>

        <!-- Home (Center Circle) -->
        <a href="/<%= token %>/movies-hub?userId=<%= user_id %>&fromId=<%= typeof fromId !== 'undefined' ? fromId : '' %>"
            class="absolute -top-6 left-1/2 transform -translate-x-1/2 bg-blue-600 rounded-full p-4 shadow-lg <%= currentPath === '/' ? 'ring-2 ring-blue-300' : '' %>">
            <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0h6" />
            </svg>
        </a>

        <!-- Profile (Right) -->
        <a data-ad="interstitial"
            href="/<%= token %>/movies-hub/profile?userId=<%= user_id %>&fromId=<%= typeof fromId !== 'undefined' ? fromId : '' %>"
            class="flex-1 text-center py-3 <%= currentPath === '/movies-hub/profile' ? 'text-blue-300 bg-gray-600' : '' %>">
            <svg class="mx-auto w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path d="M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2" />
                <circle cx="8.5" cy="7" r="4" />
            </svg>
            <span class="text-xs block">Profile</span>
        </a>

    </div>
</footer>

<!-- AdsGram Client-only Integration -->
<script>
    (function () {

        const ADS_BLOCK_ID = 'int-20013'; // <-- CHANGE THIS

        const SAFETY_TIMEOUT_MS = 8000;
        const SDK_LOAD_DELAY_MS = 300;

        let AdController = null;
        let sdkLoaded = false;
        let sdkRequested = false;

        function loadAdsgram() {
            if (sdkRequested) return;
            sdkRequested = true;

            if (window.Adsgram?.init) {
                try {
                    AdController = window.Adsgram.init({ blockId: ADS_BLOCK_ID });
                    sdkLoaded = true;
                    return;
                } catch (e) { console.error(e); }
            }

            const s = document.createElement('script');
            s.src = 'https://sad.adsgram.ai/js/sad.min.js';
            s.async = true;
            s.onload = function () {
                try {
                    if (window.Adsgram?.init) {
                        AdController = window.Adsgram.init({ blockId: ADS_BLOCK_ID });
                        sdkLoaded = true;
                    }
                } catch (e) {
                    console.error('Adsgram init failed:', e);
                }
            };
            s.onerror = () => console.error('Adsgram SDK load failed.');
            document.head.appendChild(s);
        }

        function attachAdNav() {
            const links = document.querySelectorAll('footer a[data-ad]');
            links.forEach(a => {
                a.addEventListener('click', async function (ev) {
                    ev.preventDefault();
                    const href = this.href;

                    if (!sdkLoaded && !sdkRequested) {
                        loadAdsgram();
                        await new Promise(r => setTimeout(r, SDK_LOAD_DELAY_MS));
                    }

                    let navigated = false;
                    const go = () => {
                        if (navigated) return;
                        navigated = true;
                        window.location.href = href;
                    };

                    const timer = setTimeout(go, SAFETY_TIMEOUT_MS);

                    try {
                        if (sdkLoaded && AdController?.show) {
                            const res = await AdController.show();
                            clearTimeout(timer);
                            // client-only behaviour: navigate regardless of done/skip
                            go();
                        } else {
                            clearTimeout(timer);
                            go();
                        }
                    } catch (err) {
                        console.error('Ad show error:', err);
                        clearTimeout(timer);
                        go();
                    }
                }, { passive: false });
            });
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                loadAdsgram();
                attachAdNav();
            });
        } else {
            loadAdsgram();
            attachAdNav();
        }

    })();
</script>