<!-- Movie card (fixed to behave like "shows" template) -->
<section class="w-full max-w-md bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col min-h-[100svh]">

    <!-- Movie Thumbnail -->
    <div class="relative w-full max-h-[350px] overflow-hidden rounded-lg">
        <img src="<%= updatedMovieDetails.thumbnail %>" alt="<%= updatedMovieDetails.title %>"
            class="w-full h-auto object-contain animate-verticalScroll">
        <span class="absolute top-2 left-2 bg-purple-600 text-white text-xs px-3 py-1 rounded-full shadow">
            <%= updatedMovieDetails.quality.join(", ") %>
        </span>
    </div>

    <!-- Main Content -->
    <main id=" contentGrid" class="flex-1 overflow-y-auto px-6 py-4 bg-gray-50">

                <!-- Title -->
                <h1 class="text-lg font-bold text-gray-800 leading-tight">
                    <%= updatedMovieDetails.title %>
                </h1>

                <!-- Release Date + Category -->
                <div class="flex justify-between items-center mt-2 text-sm text-gray-600">
                    <span>üìÖ Release Date: <%= updatedMovieDetails.release_date %></span>
                    <span class="px-2 py-0.5 bg-blue-100 text-blue-600 rounded-full text-xs font-medium">
                        <%= updatedMovieDetails.category %>
                    </span>
                </div>

                <!-- Languages -->
                <div class="mt-3 flex flex-wrap gap-2">
                    <% updatedMovieDetails.language.split(",").forEach(lang=> { %>
                        <span class="px-2 py-1 bg-green-100 text-green-600 text-xs rounded-full">
                            <%= lang.trim() %>
                        </span>
                        <% }) %>
                </div>

                <!-- Genre -->
                <p class="mt-3 text-sm text-gray-700">
                    üé≠ <%= updatedMovieDetails.genre %>
                </p>

                <!-- Download Links -->
                <div class="mt-5">
                    <h2 class="text-sm font-semibold text-gray-800 mb-2">‚¨áÔ∏è Download Links</h2>
                    <% updatedMovieDetails.download_link.forEach((link, i)=> { %>
                        <button
                            class="download-btn block w-full text-center py-2 mb-2 bg-purple-600 text-white rounded-lg shadow hover:bg-purple-700 transition"
                            data-url="<%= link %>" data-movie-id="<%= updatedMovieDetails._id %>">
                            ‚¨áÔ∏è Download <%= updatedMovieDetails.quality[i] %>
                        </button>
                        <% }) %>
                </div>

                </main>

                <!-- Pagination (Optional if needed) -->
                <footer id="pagination" class="px-6 mt-3 pb-3 flex justify-center space-x-2"></footer>

                <!-- Footer -->
                <%- include('../partials/footer') %>
</section>

<!-- Simple shortlink generator + open (same pattern as shows) -->
<script>
    document.querySelectorAll(".download-btn").forEach(btn => {
        btn.addEventListener("click", async () => {
            const originalUrl = btn.dataset.url;
            const movieId = btn.dataset.movieId;

            try {
                const res = await axios.post("/<%= token %>/movies-hub/get_shortlink", {
                    url: originalUrl,
                    movie_id: movieId,
                    fromId: "<%= fromId %>",
                });

                if (res.data && res.data.success && res.data.short_link) {
                    window.open(res.data.short_link, "_blank", "noopener,noreferrer");
                } else {
                    alert("Error: Could not generate shortlink.");
                }
            } catch (err) {
                console.error("Shortlink error:", err);
                alert("Failed to generate shortlink. Please try again.");
            }
        });
    });
</script>

<!-- Ad / Mini-app call (kept the same as shows) -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        if (typeof show_10399131 === 'function') {
            show_10399131().then(() => {/* success */ }).catch(() => {/* silent */ });
        }
    });
</script>