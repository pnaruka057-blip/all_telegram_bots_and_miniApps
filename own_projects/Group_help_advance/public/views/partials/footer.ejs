<!-- Developed By Section -->
<footer class="mt-2 text-center text-sm flex items-center justify-center space-x-2 mb-[40px] select-none
         text-gray-600 dark:text-gray-400">
    <!-- Icon color now follows theme via currentColor -->
    <svg class="w-6 h-6 text-gray-800 dark:text-gray-200" fill="currentColor" version="1.1" id="Layer_1"
        xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"
        xml:space="preserve" aria-hidden="true" focusable="false">
        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
        <g id="SVGRepo_iconCarrier">
            <style type="text/css">
                .st0 {
                    fill: none;
                }
            </style>

            <path
                d="M19.2,4.4L2.9,10.7c-1.1,0.4-1.1,1.1-0.2,1.3l4.1,1.3l1.6,4.8c0.2,0.5,0.1,0.7,0.6,0.7c0.4,0,0.6-0.2,0.8-0.4 c0.1-0.1,1-1,2-2l4.2,3.1c0.8,0.4,1.3,0.2,1.5-0.7l2.8-13.1C20.6,4.6,19.9,4,19.2,4.4z M17.1,7.4l-7.8,7.1L9,17.8L7.4,13l9.2-5.8 C17,6.9,17.4,7.1,17.1,7.4z">
            </path>
            <rect y="0" class="st0" width="24" height="24"></rect>
        </g>
    </svg>

    <span>
        Developed By
        <a href="https://t.me/<%= developer_telegram_username %>" target="_blank" rel="noopener noreferrer"
            class="text-blue-600 dark:text-blue-400 hover:underline">
            Bots & Mini App Creater
        </a>
    </span>
</footer>


<!-- AdsGram Client-only Integration -->
<script>
    (function () {

        const ADS_BLOCK_ID = 'int-20013'; // <-- CHANGE THIS

        const SAFETY_TIMEOUT_MS = 8000;
        const SDK_LOAD_DELAY_MS = 300;

        let AdController = null;
        let sdkLoaded = false;
        let sdkRequested = false;

        function loadAdsgram() {
            if (sdkRequested) return;
            sdkRequested = true;

            if (window.Adsgram?.init) {
                try {
                    AdController = window.Adsgram.init({ blockId: ADS_BLOCK_ID });
                    sdkLoaded = true;
                    return;
                } catch (e) { console.error(e); }
            }

            const s = document.createElement('script');
            s.src = 'https://sad.adsgram.ai/js/sad.min.js';
            s.async = true;
            s.onload = function () {
                try {
                    if (window.Adsgram?.init) {
                        AdController = window.Adsgram.init({ blockId: ADS_BLOCK_ID });
                        sdkLoaded = true;
                    }
                } catch (e) {
                    console.error('Adsgram init failed:', e);
                }
            };
            s.onerror = () => console.error('Adsgram SDK load failed.');
            document.head.appendChild(s);
        }

        function attachAdNav() {
            const links = document.querySelectorAll('footer a[data-ad]');
            links.forEach(a => {
                a.addEventListener('click', async function (ev) {
                    ev.preventDefault();
                    const href = this.href;

                    if (!sdkLoaded && !sdkRequested) {
                        loadAdsgram();
                        await new Promise(r => setTimeout(r, SDK_LOAD_DELAY_MS));
                    }

                    let navigated = false;
                    const go = () => {
                        if (navigated) return;
                        navigated = true;
                        window.location.href = href;
                    };

                    const timer = setTimeout(go, SAFETY_TIMEOUT_MS);

                    try {
                        if (sdkLoaded && AdController?.show) {
                            const res = await AdController.show();
                            clearTimeout(timer);
                            go();
                        } else {
                            clearTimeout(timer);
                            go();
                        }
                    } catch (err) {
                        console.error('Ad show error:', err);
                        clearTimeout(timer);
                        go();
                    }
                }, { passive: false });
            });
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                loadAdsgram();
                attachAdNav();
            });
        } else {
            loadAdsgram();
            attachAdNav();
        }

    })();
</script>