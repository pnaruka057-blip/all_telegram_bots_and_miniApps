<% const BOT_NAME=(typeof botName !=="undefined" && botName) ? botName : "Group Help Advance Bot" ; const
    BOT_HANDLE=(typeof botHandle !=="undefined" && botHandle) ? botHandle : "@GroupHelpAdvanceBot" ; const
    BRAND_NAME=(typeof brandName !=="undefined" && brandName) ? brandName : "Group Help Advance" ; const
    SUPPORT_TG=(typeof supportTelegram !=="undefined" && supportTelegram) ? supportTelegram : "" ; const
    OWNER_NAME=(typeof ownerName !=="undefined" && ownerName) ? ownerName : "Your Name / Company" ; const
    OWNER_ADDRESS=(typeof ownerAddress !=="undefined" && ownerAddress) ? ownerAddress : "" ; const LAST_UPDATED=(typeof
    lastUpdated !=="undefined" && lastUpdated) ? lastUpdated : "December 29, 2025" ; const BOT_LOGO_URL=(typeof
    botLogoUrl !=="undefined" && botLogoUrl) ? botLogoUrl : "" ; %>

    <section class="min-h-screen bg-slate-50 text-slate-900 dark:bg-slate-950 dark:text-slate-100">
        <!-- Safe-area vars early (reduce flicker) -->
        <style>
            :root {
                --app-safe-top: env(safe-area-inset-top, 0px);
                --app-safe-bottom: env(safe-area-inset-bottom, 0px);
            }
        </style>

        <script>
            (function () {
                const root = document.documentElement;
                const tg = window.Telegram && window.Telegram.WebApp ? window.Telegram.WebApp : null;

                function numCssVar(name) {
                    const v = getComputedStyle(root).getPropertyValue(name);
                    const n = parseFloat(v);
                    return Number.isFinite(n) ? n : 0;
                }

                function setSafeVars() {
                    let top = 0, bottom = 0;

                    try {
                        top = tg?.safeAreaInset?.top ?? 0;
                        bottom = tg?.safeAreaInset?.bottom ?? 0;
                    } catch (e) { }

                    if (!top) top = numCssVar('--tg-safe-area-inset-top');
                    if (!bottom) bottom = numCssVar('--tg-safe-area-inset-bottom');

                    if (!top && /iPhone|iPad|iPod/i.test(navigator.userAgent)) top = 24;

                    root.style.setProperty('--app-safe-top', top + 'px');
                    root.style.setProperty('--app-safe-bottom', bottom + 'px');
                }

                setSafeVars();

                try { tg?.onEvent?.('safeAreaChanged', setSafeVars); } catch (e) { }
                try { tg?.onEvent?.('safe_area_changed', setSafeVars); } catch (e) { }

                try {
                    if (tg?.setHeaderColor && tg?.colorScheme) {
                        tg.setHeaderColor(tg.colorScheme === 'dark' ? '#020617' : '#f8fafc');
                    }
                    if (tg?.setBackgroundColor && tg?.colorScheme) {
                        tg.setBackgroundColor(tg.colorScheme === 'dark' ? '#020617' : '#f8fafc');
                    }
                } catch (e) { }
            })();
        </script>

        <!-- HERO -->
        <%- include('../partials/header') %>

            <!-- Sticky top bar -->
            <header
                class="sticky top-0 z-20 border-b border-slate-200/70 bg-slate-50/80 backdrop-blur dark:border-slate-800/70 dark:bg-slate-950/70">
                <div class="mx-auto flex max-w-3xl items-center gap-3 px-4 py-3">
                    <!-- Logo -->
                    <div class="shrink-0">
                        <% if (BOT_LOGO_URL && String(BOT_LOGO_URL).trim()) { %>
                            <img src="<%= BOT_LOGO_URL %>" alt="Bot logo"
                                class="h-10 w-10 rounded-2xl object-cover bg-white dark:bg-slate-900" loading="lazy" />
                            <% } else { %>
                                <div
                                    class="h-10 w-10 rounded-2xl bg-slate-900 text-white dark:bg-white dark:text-slate-900 flex items-center justify-center font-semibold">
                                    GH
                                </div>
                                <% } %>
                    </div>

                    <!-- Title -->
                    <div class="min-w-0">
                        <p class="text-xs text-slate-600 dark:text-slate-400">Telegram Bot</p>
                        <h1 class="truncate text-base font-semibold sm:text-lg">
                            <%= BOT_NAME %>
                        </h1>
                    </div>
                </div>
            </header>

            <main class="mx-auto max-w-3xl px-4 pb-12 pt-6">
                <!-- Intro -->
                <div class="space-y-2">
                    <h2 class="text-xl font-semibold tracking-tight sm:text-2xl">Privacy Policy</h2>

                    <p class="text-sm leading-relaxed text-slate-700 dark:text-slate-300">
                        At <span class="font-medium">
                            <%= BRAND_NAME %>
                        </span>, the privacy and safety of users and groups is a priority.
                        This Privacy Policy describes what information may be processed while operating the Telegram
                        bot(s), why it is processed,
                        and what rights you have.
                    </p>

                    <p class="text-sm leading-relaxed text-slate-700 dark:text-slate-300">
                        This page also explains how you use <span class="font-medium">
                            <%= BOT_HANDLE %>
                        </span> and any connected bots/services.
                    </p>

                    <p class="text-sm leading-relaxed text-slate-700 dark:text-slate-300">
                        For support or privacy requests, contact us on Telegram:
                        <% if (SUPPORT_TG && String(SUPPORT_TG).trim()) { %>
                            <a class="underline decoration-slate-400 underline-offset-4 hover:decoration-slate-700 dark:decoration-slate-600 dark:hover:decoration-slate-200"
                                href="<%= SUPPORT_TG %>" target="_blank" rel="noopener">
                                <%= SUPPORT_TG %>
                            </a>
                            <% } else { %>
                                <span class="font-medium">Support link not configured.</span>
                                <% } %>
                    </p>
                </div>

                <!-- Sections -->
                <div class="mt-6 space-y-8">
                    <section>
                        <h3 class="text-sm font-semibold text-slate-900 dark:text-slate-100">Scope</h3>
                        <div class="mt-2 text-sm leading-relaxed text-slate-700 dark:text-slate-300">
                            <ul class="list-disc pl-5 space-y-1">
                                <li>This policy applies to interactions on Telegram with <%= BOT_HANDLE %> and any
                                        connected bots/services.</li>
                                <li>It covers data that you provide, data generated by using bot features, and data that
                                    Telegram shares through its APIs.</li>
                                <li>It does not cover offline collection or third-party services not used by the bot.
                                </li>
                            </ul>
                        </div>
                    </section>

                    <section>
                        <h3 class="text-sm font-semibold text-slate-900 dark:text-slate-100">Lawful bases</h3>
                        <div class="mt-2 space-y-2 text-sm leading-relaxed text-slate-700 dark:text-slate-300">
                            <p>
                                Consent is not always requested because certain minimal processing is necessary to
                                provide the group-protection
                                and moderation features requested by group owners/admins, and to operate the bot
                                reliably.
                            </p>
                            <ul class="list-disc pl-5 space-y-1">
                                <li><span class="font-semibold">Public interest & safety:</span> helping groups reduce
                                    spam/abuse and enforce rules.</li>
                                <li><span class="font-semibold">Legitimate interests:</span> allowing administrators to
                                    manage communities efficiently and securely.</li>
                                <li><span class="font-semibold">Necessity:</span> when you choose to use bot features,
                                    processing is needed to deliver them.</li>
                            </ul>
                        </div>
                    </section>

                    <section>
                        <h3 class="text-sm font-semibold text-slate-900 dark:text-slate-100">Data we may process</h3>
                        <div class="mt-2 space-y-4 text-sm leading-relaxed text-slate-700 dark:text-slate-300">
                            <p>
                                The bot is designed to store only what is needed for moderation, automation, analytics
                                for group health, and support handling.
                                Depending on which features are enabled by a group admin, the bot may process the
                                categories below.
                            </p>

                            <div class="space-y-2">
                                <h4 class="text-sm font-semibold text-slate-900 dark:text-slate-100">1) Basic Telegram
                                    account details</h4>
                                <ul class="list-disc pl-5 space-y-1">
                                    <li>Examples: Telegram user ID, display name, username (if any), language,
                                        timestamps (when available).</li>
                                    <li>Purpose: moderation commands, abuse prevention, audits.</li>
                                </ul>
                            </div>

                            <div class="space-y-2">
                                <h4 class="text-sm font-semibold text-slate-900 dark:text-slate-100">2) Group activity &
                                    membership metadata</h4>
                                <ul class="list-disc pl-5 space-y-1">
                                    <li>Examples: group identifiers, membership status, activity timestamps, counters
                                        (feature-dependent).</li>
                                    <li>Purpose: group analytics, moderation workflows.</li>
                                </ul>
                            </div>

                            <div class="space-y-2">
                                <h4 class="text-sm font-semibold text-slate-900 dark:text-slate-100">3) Admin/owner
                                    permissions metadata</h4>
                                <ul class="list-disc pl-5 space-y-1">
                                    <li>Examples: creator/admin status and permissions (as provided by Telegram).</li>
                                    <li>Purpose: authorize settings panels and privileged commands.</li>
                                </ul>
                            </div>

                            <div class="space-y-2">
                                <h4 class="text-sm font-semibold text-slate-900 dark:text-slate-100">4) Warnings /
                                    punishments (feature-dependent)</h4>
                                <ul class="list-disc pl-5 space-y-1">
                                    <li>Examples: warning count, mute/ban records and expiry.</li>
                                    <li>Purpose: consistent enforcement of anti-spam/anti-abuse rules.</li>
                                </ul>
                            </div>

                            <div class="space-y-2">
                                <h4 class="text-sm font-semibold text-slate-900 dark:text-slate-100">5) Support requests
                                </h4>
                                <ul class="list-disc pl-5 space-y-1">
                                    <li>Examples: messages you send to support, timestamps, related identifiers.</li>
                                    <li>Purpose: provide support, investigate abuse, improve service quality.</li>
                                </ul>
                            </div>
                        </div>
                    </section>

                    <section>
                        <h3 class="text-sm font-semibold text-slate-900 dark:text-slate-100">Data sharing</h3>
                        <div class="mt-2 text-sm leading-relaxed text-slate-700 dark:text-slate-300">
                            <ul class="list-disc pl-5 space-y-1">
                                <li>Telegram: bot uses Telegram APIs; Telegram processes data under its own policies.
                                </li>
                                <li>Group staff: group-related info may be visible to authorized admins/moderators via
                                    bot features.</li>
                                <li>Service operators: limited access for operations/support and abuse handling.</li>
                            </ul>
                        </div>
                    </section>

                    <section>
                        <h3 class="text-sm font-semibold text-slate-900 dark:text-slate-100">Your data protection rights
                        </h3>
                        <div class="mt-2 space-y-2 text-sm leading-relaxed text-slate-700 dark:text-slate-300">
                            <p>
                                Depending on your jurisdiction, you may have rights such as access, correction,
                                deletion, restriction, and complaint rights.
                            </p>
                            <ul class="list-disc pl-5 space-y-1">
                                <li><span class="font-semibold">Access:</span> request a copy of data we hold about you.
                                </li>
                                <li><span class="font-semibold">Erasure:</span> request deletion, unless required for
                                    safety/legal reasons.</li>
                                <li><span class="font-semibold">Restriction/Objection:</span> request limited processing
                                    in certain cases.</li>
                            </ul>
                        </div>
                    </section>

                    <section>
                        <h3 class="text-sm font-semibold text-slate-900 dark:text-slate-100">Children’s information</h3>
                        <div class="mt-2 text-sm leading-relaxed text-slate-700 dark:text-slate-300">
                            <p>
                                The service is not intended to knowingly collect personal data from children under the
                                age required by applicable law.
                            </p>
                        </div>
                    </section>

                    <section>
                        <h3 class="text-sm font-semibold text-slate-900 dark:text-slate-100">Contact
                            (controller/operator)</h3>
                        <div class="mt-2 space-y-2 text-sm leading-relaxed text-slate-700 dark:text-slate-300">
                            <ul class="space-y-1">
                                <li><span class="font-semibold">Name:</span>
                                    <%= OWNER_NAME %>
                                </li>

                                <% if (OWNER_ADDRESS && String(OWNER_ADDRESS).trim()) { %>
                                    <li><span class="font-semibold">Address:</span>
                                        <%= OWNER_ADDRESS %>
                                    </li>
                                    <% } %>

                                        <li>
                                            <span class="font-semibold">Support (Telegram):</span>
                                            <% if (SUPPORT_TG && String(SUPPORT_TG).trim()) { %>
                                                <a class="underline underline-offset-4" href="<%= SUPPORT_TG %>"
                                                    target="_blank" rel="noopener">
                                                    <%= SUPPORT_TG %>
                                                </a>
                                                <% } else { %>
                                                    <span class="font-medium">Not configured</span>
                                                    <% } %>
                                        </li>
                            </ul>

                            <p class="text-xs text-slate-600 dark:text-slate-400">Last update: <%= LAST_UPDATED %>
                            </p>
                        </div>
                    </section>
                </div>
            </main>

            <!-- Footer -->
            <%- include('../partials/footer') %>
    </section>

    <script>
        (function () {
            // Native Telegram Back Button (optional) [web:217]
            function goBack() {
                if (window.history.length > 1) return window.history.back();
                return window.location.href = "/<%= token %>/group-help-advance";
            }

            try {
                const tg = window.Telegram && window.Telegram.WebApp ? window.Telegram.WebApp : null;
                if (tg?.BackButton) {
                    tg.BackButton.show();
                    tg.BackButton.onClick(goBack);
                }
            } catch (e) { }
        })();
    </script>

    <script>
        (function () {
            const SHOW_FN_NAME = 'show_10401300';
            const AD_SHOW_TIMEOUT_MS = 30000;
            const SDK_POLL_INTERVAL_MS = 500;

            // ---- Global guard: prevents multiple runs on same page ----
            const KEY = '__monetag_ads_flow_' + SHOW_FN_NAME;
            if (window[KEY]?.running || window[KEY]?.finished) return;

            window[KEY] = {
                running: true,
                finished: false,
                controller: null,
                overallTimer: null,
                pollInterval: null,
                prevHtmlOverflow: '',
                prevBodyOverflow: '',
            };

            const state = window[KEY];

            function stopper(e) {
                try {
                    e.stopImmediatePropagation();
                    e.preventDefault();
                } catch (_) { }
                return false;
            }

            function attachCaptureBlockers() {
                if (state.controller) return;

                // AbortController makes cleanup reliable (abort removes listeners). [web:587]
                const controller = new AbortController();
                state.controller = controller;

                const optCap = { capture: true, signal: controller.signal };
                const optWheel = { capture: true, passive: false, signal: controller.signal };

                document.addEventListener('click', stopper, optCap);
                document.addEventListener('pointerdown', stopper, optCap);
                document.addEventListener('touchstart', stopper, optCap);
                document.addEventListener('wheel', stopper, optWheel);
                document.addEventListener('keydown', stopper, optCap);
            }

            function removeCaptureBlockers() {
                try { state.controller?.abort(); } catch (_) { }
                state.controller = null;
            }

            function ensureSpinStyleOnce() {
                if (document.getElementById('adsSpinStyle')) return;
                const style = document.createElement('style');
                style.id = 'adsSpinStyle';
                style.textContent = `@keyframes adsSpin { from{transform:rotate(0deg);} to{transform:rotate(360deg);} }`;
                document.head.appendChild(style);
            }

            function createLoadingBlocker() {
                if (document.getElementById('ads-loading-blocker')) return;

                try {
                    state.prevHtmlOverflow = document.documentElement.style.overflow || '';
                    state.prevBodyOverflow = document.body.style.overflow || '';
                    document.documentElement.style.overflow = 'hidden';
                    document.body.style.overflow = 'hidden';
                } catch (_) { }

                attachCaptureBlockers();
                ensureSpinStyleOnce();

                const el = document.createElement('div');
                el.id = 'ads-loading-blocker';

                Object.assign(el.style, {
                    position: 'fixed',
                    inset: '0',
                    width: '100%',
                    height: '100%',
                    zIndex: '2147483647',
                    background: 'rgba(0,0,0,0.35)',
                    backdropFilter: 'blur(2px)',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    pointerEvents: 'auto',
                    touchAction: 'none'
                });

                el.innerHTML = `
        <div style="
          color:#e5e7eb;
          padding:14px 18px;
          border-radius:14px;
          box-shadow:0 10px 35px rgba(0,0,0,.35);
          font-family: system-ui, -apple-system, Segoe UI, Roboto;
          text-align:center;
          min-width:120px;
        ">
          <div style="
            width:26px;height:26px;
            border-radius:50%;
            border:3px solid #38bdf8;
            border-top-color:transparent;
            margin:0 auto 8px auto;
            animation: adsSpin 0.85s linear infinite;
          "></div>
          <div style="font-size:12px;opacity:.9;">Loading…</div>
        </div>
      `;

                document.body.appendChild(el);
            }

            function removeLoadingBlocker() {
                try {
                    const el = document.getElementById('ads-loading-blocker');
                    if (el) el.remove();
                } catch (_) { }

                try {
                    document.documentElement.style.overflow = state.prevHtmlOverflow;
                    document.body.style.overflow = state.prevBodyOverflow;
                } catch (_) { }

                removeCaptureBlockers();
            }

            function clearAllTimers() {
                if (state.overallTimer) clearTimeout(state.overallTimer);
                if (state.pollInterval) clearInterval(state.pollInterval);
                state.overallTimer = null;
                state.pollInterval = null;
            }

            function finish() {
                if (state.finished) return;
                state.finished = true;
                state.running = false;
                clearAllTimers();
                removeLoadingBlocker();
            }

            function tryShowWithTimeout(showFn) {
                return new Promise((resolve, reject) => {
                    let settled = false;

                    const safety = setTimeout(() => {
                        if (settled) return;
                        settled = true;
                        reject(new Error('ad-timeout'));
                    }, AD_SHOW_TIMEOUT_MS);

                    Promise.resolve()
                        .then(() => showFn())
                        .then((res) => {
                            if (settled) return;
                            settled = true;
                            clearTimeout(safety);
                            resolve(res);
                        })
                        .catch((err) => {
                            if (settled) return;
                            settled = true;
                            clearTimeout(safety);
                            reject(err);
                        });
                });
            }

            function runShowFlow() {
                try {
                    createLoadingBlocker();

                    state.overallTimer = setTimeout(() => {
                        finish();
                    }, AD_SHOW_TIMEOUT_MS);

                    state.pollInterval = setInterval(() => {
                        const fn = window[SHOW_FN_NAME];
                        if (typeof fn === 'function') {
                            clearAllTimers();
                            tryShowWithTimeout(fn)
                                .then(() => finish())
                                .catch(() => finish());
                        }
                    }, SDK_POLL_INTERVAL_MS);

                } catch (_) {
                    finish();
                }
            }

            // Extra safety: if user leaves page / app background, cleanup
            window.addEventListener('pagehide', finish, { once: true });
            document.addEventListener('visibilitychange', () => {
                if (document.hidden) finish();
            });

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', runShowFlow, { once: true });
            } else {
                runShowFlow();
            }
        })();
    </script>